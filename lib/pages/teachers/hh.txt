// ignore_for_file: prefer_const_constructors, prefer_const_literals_to_create_immutables, sort_child_properties_last

import 'package:flutter/material.dart';

class ChatInput extends StatefulWidget {
  ChatInput({
    super.key,
  });

  @override
  State<ChatInput> createState() => _ChatInputState();
}

class _ChatInputState extends State<ChatInput> {
  TextEditingController controller = TextEditingController();

  bool isTyping = false;

  @override
  Widget build(BuildContext context) {
    return Padding(
      padding: const EdgeInsets.only(
        top: 10,
      ),
      child: Row(children: [
        Expanded(
          child: ConstrainedBox(
            constraints: BoxConstraints(maxHeight: 100),
            child: Container(
              padding: EdgeInsets.only(
                top: 3,
              ),
              height: 80,
              color: Theme.of(context).primaryColor,
              child: TextField(
                keyboardType: TextInputType.multiline,
                minLines: 1,
                maxLines: 100,
                controller: controller,
                onChanged: (value) {
                  if (value.isNotEmpty || value != "") {
                    setState(() {
                      isTyping = true;
                    });
                  } else {
                    setState(() {
                      isTyping = false;
                    });
                  }
                },
                style: TextStyle(color: Theme.of(context).colorScheme.tertiary),
                decoration: InputDecoration(
                    labelStyle: TextStyle(
                      color: Colors.blue,
                      fontSize: 17,
                    ),
                    prefixIcon: PopupMenuButton(
                        surfaceTintColor:
                            Theme.of(context).colorScheme.background,
                        icon: Icon(Icons.add),
                        color: Colors.blue,
                        iconColor: Colors.blue,
                        itemBuilder: ((context) => [
                              PopupMenuItem(
                                child: ListTile(
                                  leading:
                                      Icon(Icons.photo, color: Colors.blue),
                                  title: Text(
                                    "Media",
                                    style: TextStyle(color: Colors.blue),
                                  ),
                                ),
                                value: "Media",
                              ),
                              PopupMenuItem(
                                child: ListTile(
                                  leading: Icon(Icons.attach_file,
                                      color: Colors.blue),
                                  title: Text(
                                    "File",
                                    style: TextStyle(color: Colors.blue),
                                  ),
                                ),
                                value: "File",
                              ),
                              PopupMenuItem(
                                child: ListTile(
                                  leading:
                                      Icon(Icons.contacts, color: Colors.blue),
                                  title: Text(
                                    "Contact",
                                    style: TextStyle(color: Colors.blue),
                                  ),
                                ),
                                value: "Contact",
                              )
                            ])),
                    suffixIcon: Row(
                      mainAxisSize: MainAxisSize.min,
                      children: [
                        isTyping
                            ? SizedBox()
                            : Row(
                                children: [
                                  IconButton(
                                    onPressed: () {},
                                    icon: Icon(
                                      Icons.camera_alt,
                                      color: Colors.blue,
                                    ),
                                  ),
                                  IconButton(
                                    onPressed: () {},
                                    icon: Icon(
                                      Icons.mic,
                                      color: Colors.blue,
                                    ),
                                  ),
                                ],
                              ),
                        isTyping
                            ? IconButton(
                                onPressed: () {},
                                icon: Icon(
                                  Icons.send_rounded,
                                  color: Colors.blue,
                                ),
                                iconSize: 30,
                                splashColor: Colors.blue,
                              )
                            : SizedBox(),
                      ],
                    ),
                    enabledBorder: OutlineInputBorder(
                        borderSide: BorderSide.none,
                        borderRadius: BorderRadius.zero),
                    focusedBorder: OutlineInputBorder(
                        borderSide: BorderSide.none,
                        borderRadius: BorderRadius.zero),
                    fillColor: Theme.of(context).primaryColor,
                    filled: true,
                    hintText: "Type your message",
                    hintStyle: TextStyle(color: Colors.blue)),
              ),
            ),
          ),
        ),
      ]),
    );
  }
}
